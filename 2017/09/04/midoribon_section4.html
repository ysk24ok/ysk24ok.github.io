<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="author" content="ysk24ok">
  
  <meta name="description" content="みどりぼん第4章 GLMのモデル選択を読んでまとめた。">
  <meta property="og:description" content="みどりぼん第4章 GLMのモデル選択を読んでまとめた。">
  
  <meta property="og:image" content="https://ysk24ok.github.io/assets/images/profile.jpeg">
  <meta property="og:title" content="みどりぼん 第4章 GLMのモデル選択">
  <meta property="og:url" content="https://ysk24ok.github.io/2017/09/04/midoribon_section4.html">
  <meta property="og:type" content="article">
  <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
  <!-- MathJax -->
  <!-- http://docs.mathjax.org/en/latest/start.html#secure-access-to-the-cdn -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ['\\(','\\)'] ],
        processEscapes: true
      }
    });
  </script>
  <script type="text/javascript" async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- bootstrap -->
  <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap.min.css">
  <script src="/assets/js/jquery-2.1.4.min.js"></script>
  <script src="/assets/js/bootstrap.min.js"></script>
  <!-- github.io default -->
  <link rel="stylesheet" type="text/css" href="/assets/css/stylesheet.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/assets/css/github-dark.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/assets/css/print.css" media="print">
  <!-- syntax highlight css -->
  <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css" media="screen">
  <!-- My customized css -->
  <link rel="stylesheet" type="text/css" href="/assets/css/main.css" media="screen">
  <!-- RSS -->
  <link href="/feed.xml" type="application/rss+xml" rel="alternate" title="ysk24ok.github.io" />
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131519041-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-131519041-1');
  </script>
  <!--[if lt IE 9]>
  <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <title>みどりぼん 第4章 GLMのモデル選択 - ysk24ok.github.io</title>
</head>

  <body>
    <div id="container">
      <div class="inner">
        <header>
  <h1><a href="/">ysk24ok.github.io</a></h1>
</header>
<nav class="navbar navbar-default" role="navigation">
  <ul id="main-navigation" class="nav navbar-nav">
    <li><a href="/">Home</a></li>
    <li><a href="/about">About</a></li>
  </ul>
</nav>

        <div class="post-item">
          <div class="post-header">
  <h1>
    <a href="/2017/09/04/midoribon_section4.html">みどりぼん 第4章 GLMのモデル選択</a>
  </h1>
  <ul class="post-tags">
    
      <li><a href="#">midoribon</a></li>
    
      <li><a href="#">GLM</a></li>
    
      <li><a href="#">Japanese</a></li>
    
  </ul>
  
  <div class="post-date">posted on 04 Sep 2017</div>
  
  <hr>
</div>

          <div class="post-content">
            <ul class="social-buttons">
  <!-- hatena bookmark -->
  <li>
    <a href="http://b.hatena.ne.jp/entry/ysk24ok.github.io/2017/09/04/midoribon_section4.html" class="hatena-bookmark-button" data-hatena-bookmark-title="みどりぼん 第4章 GLMのモデル選択 - ysk24ok.github.io" data-hatena-bookmark-layout="simple-balloon" title="このエントリーをはてなブックマークに追加">
      <img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
    </a>
    <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
  </li>
  <!-- twitter -->
  <li>
    <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </li>
</ul>

            <p>みどりぼん第4章 GLMのモデル選択を読んでまとめた。</p>

<!-- more -->

<ul>
  <li><a href="http://hosho.ees.hokudai.ac.jp/~kubo/stat/iwanamibook/fig/poisson/data3a.csv">data3a.csv</a></li>
  <li><a href="https://nbviewer.jupyter.org/gist/ysk24ok/4f057866adf7876a34d4541929186f0e">notebook</a></li>
</ul>

<h2 id="モデル選択規準aic">モデル選択規準AIC</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: center">モデル</th>
      <th style="text-align: center">パラメータ数<br />$k$</th>
      <th style="text-align: center">最大対数尤度<br />$\log L^{*}$</th>
      <th style="text-align: center">逸脱度<br />$-2\log L^{*}$</th>
      <th style="text-align: center">残差逸脱度</th>
      <th style="text-align: center">平均対数尤度<br />$\log L^{*}-k$</th>
      <th style="text-align: center">AIC<br />$-2(\log L^{*}-k)$</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">null model</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">-237.64</td>
      <td style="text-align: center">475.29</td>
      <td style="text-align: center">89.51</td>
      <td style="text-align: center">-238.64</td>
      <td style="text-align: center">477.29</td>
    </tr>
    <tr>
      <td style="text-align: center">$x$</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">-235.39</td>
      <td style="text-align: center">470.77</td>
      <td style="text-align: center">84.99</td>
      <td style="text-align: center">-237.39</td>
      <td style="text-align: center">474.77</td>
    </tr>
    <tr>
      <td style="text-align: center">$f$</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">-237.63</td>
      <td style="text-align: center">475.25</td>
      <td style="text-align: center">89.48</td>
      <td style="text-align: center">-239.63</td>
      <td style="text-align: center">479.25</td>
    </tr>
    <tr>
      <td style="text-align: center">$x + f$</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">-235.29</td>
      <td style="text-align: center">470.59</td>
      <td style="text-align: center">84.81</td>
      <td style="text-align: center">-238.29</td>
      <td style="text-align: center">476.59</td>
    </tr>
    <tr>
      <td style="text-align: center">full model</td>
      <td style="text-align: center">100</td>
      <td style="text-align: center">-192.89</td>
      <td style="text-align: center">385.78</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">-292.89</td>
      <td style="text-align: center">585.78</td>
    </tr>
  </tbody>
</table>

<h3 id="最大対数尤度">最大対数尤度</h3>

<ul>
  <li>$\log L^{*}$</li>
  <li>観測データに対する統計モデルの当てはまりの良さ</li>
</ul>

<h3 id="逸脱度-deviance">逸脱度 (deviance)</h3>

<ul>
  <li>$D=-2\log L^{*}$</li>
  <li>観測データに対する統計モデルの当てはまりの悪さ</li>
  <li>-2を掛けているのはカイ二乗検定との対応関係が良くなるかららしい</li>
</ul>

<h3 id="最小逸脱度最大逸脱度">最小逸脱度・最大逸脱度</h3>

<ul>
  <li>$D_{min}, D_{max}$</li>
  <li>最小逸脱度はfull modelの逸脱度、最大逸脱度はnull modelの逸脱度</li>
</ul>

<h3 id="残差逸脱度-residual-deviance">残差逸脱度 (residual deviance)</h3>

<ul>
  <li>$D-D_{min}$</li>
  <li>最小逸脱度を基準とした逸脱度</li>
  <li>statsmodelsのGLMresults.devianceで表示されるのは残差逸脱度</li>
</ul>

<h3 id="平均対数尤度">平均対数尤度</h3>

<ul>
  <li>$\log L^{*}-k$</li>
  <li>統計モデルの平均的な当てはまりの良さ</li>
  <li>たとえ無意味なパラメータでも増やせば増やすほど最大対数尤度は良化するので、<br />
パラメータ数をバイアスとして補正する</li>
</ul>

<h3 id="aic">AIC</h3>

<ul>
  <li>$-2(\log L^{*}-k)$</li>
  <li>統計モデルの平均的な当てはまりの悪さ</li>
  <li>バイアス補正した逸脱度とも言える？</li>
</ul>

<h2 id="まとめ">まとめ</h2>

<ul>
  <li>AICはネストしているモデル間の比較に有用
    <ul>
      <li>追加したパラメータが説明力があればAICは低下する</li>
      <li>追加したパラメータが無意味であればAICは増加する</li>
    </ul>
  </li>
  <li>ネストしていない複数のモデル間でAICによるモデル選択は可能か？
    <ul>
      <li>「たぶん問題ないだろうといった理由で使われているのが現状です」とある</li>
      <li>本当は使えないんだけど使われてしまっている、の意？</li>
    </ul>
  </li>
  <li>データ数が少ない場合は、真のモデルよりパラメータ数の少ない単純なモデルのほうが<br />
予測能力が高い可能性がある</li>
  <li>AIC以外のモデル選択規準には交差検証法やブートストラップ情報量規準などがある</li>
</ul>

<h2 id="参考文献サイト">参考文献・サイト</h2>

<ul>
  <li><a href="http://hosho.ees.hokudai.ac.jp/~kubo/ce/IwanamiBook.html">データ解析のための統計モデリング入門</a> 第4章</li>
</ul>

            <ul class="social-buttons">
  <!-- hatena bookmark -->
  <li>
    <a href="http://b.hatena.ne.jp/entry/ysk24ok.github.io/2017/09/04/midoribon_section4.html" class="hatena-bookmark-button" data-hatena-bookmark-title="みどりぼん 第4章 GLMのモデル選択 - ysk24ok.github.io" data-hatena-bookmark-layout="simple-balloon" title="このエントリーをはてなブックマークに追加">
      <img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
    </a>
    <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
  </li>
  <!-- twitter -->
  <li>
    <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </li>
</ul>

          </div>
        </div>
        <footer>
  This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
</footer>

      </div>
    </div>
  </body>
</html>
