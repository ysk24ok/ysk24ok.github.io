<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="author" content="ysk24ok">
  
  <meta name="description" content="My blog posts, slides and past works">
  <meta property="og:description" content="My blog posts, slides and past works">
  
  <meta property="og:image" content="https://ysk24ok.github.io/assets/images/profile.jpeg">
  <meta property="og:title" content="統計学入門 第9章 -標本分布- メモ">
  <meta property="og:url" content="https://ysk24ok.github.io/2016/06/27/statistics-introduction-section9.html">
  <meta property="og:type" content="">
  <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
  <!-- MathJax -->
  <!-- http://docs.mathjax.org/en/latest/start.html#secure-access-to-the-cdn -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ['\\(','\\)'] ],
        processEscapes: true
      }
    });
  </script>
  <script type="text/javascript" async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- bootstrap -->
  <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap.min.css">
  <script src="/assets/js/jquery-2.1.4.min.js"></script>
  <script src="/assets/js/bootstrap.min.js"></script>
  <!-- github.io default -->
  <link rel="stylesheet" type="text/css" href="/assets/css/stylesheet.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/assets/css/github-dark.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/assets/css/print.css" media="print">
  <!-- syntax highlight css -->
  <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css" media="screen">
  <!-- My customized css -->
  <link rel="stylesheet" type="text/css" href="/assets/css/main.css" media="screen">
  <!-- RSS -->
  <link href="/feed.xml" type="application/rss+xml" rel="alternate" title="ysk24ok.github.io" />
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131519041-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-131519041-1');
  </script>
  <!--[if lt IE 9]>
  <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <title>統計学入門 第9章 -標本分布- メモ - ysk24ok.github.io</title>
</head>

  <body>
    <div id="container">
      <div class="inner">
        <header>
  <h1><a href="/">ysk24ok.github.io</a></h1>
</header>
<nav class="navbar navbar-default" role="navigation">
  <ul id="main-navigation" class="nav navbar-nav">
    <li><a href="/">Home</a></li>
    <li><a href="/about">About</a></li>
  </ul>
</nav>

        <div class="post-item">
          <div class="post-header">
  <h1>
    <a href="/2016/06/27/statistics-introduction-section9.html">統計学入門 第9章 -標本分布- メモ</a>
  </h1>
  <ul class="post-tags">
    
      <li><a href="#">statistics</a></li>
    
      <li><a href="#">book</a></li>
    
      <li><a href="#">Japanese</a></li>
    
  </ul>
  
  <div class="post-date">posted on 27 Jun 2016</div>
  
  <hr>
</div>

          <div class="post-content">
            <ul class="social-buttons">
  <!-- hatena bookmark -->
  <li>
    <a href="http://b.hatena.ne.jp/entry/ysk24ok.github.io/2016/06/27/statistics-introduction-section9.html" class="hatena-bookmark-button" data-hatena-bookmark-title="統計学入門 第9章 -標本分布- メモ - ysk24ok.github.io" data-hatena-bookmark-layout="simple-balloon" title="このエントリーをはてなブックマークに追加">
      <img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
    </a>
    <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
  </li>
  <!-- twitter -->
  <li>
    <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </li>
</ul>

            <div class="post-img">
  <img src="/assets/images/statistics_introduction/cover.jpg" width="20%" />
</div>

<p><a href="http://www.utp.or.jp/bd/978-4-13-042065-5.html">統計学入門</a>の第9章をまとめた。</p>

<!-- more -->

<h2 id="母集団と標本">母集団と標本</h2>

<p><strong>母集団(population)</strong>について完全に知ることはほぼ不可能であるため、<br />
<strong>標本抽出(sampling)</strong>により標本から母集団を推定する。<br />
標本は母集団の性質を反映していると考えられるため、<br />
標本についてよく知ることは母集団について知ることにつながる。</p>

<p>母集団が従う分布に仮定を置く場合を<strong>パラメトリック</strong>と呼ぶ。
母集団の分布を決定する定数を<strong>母数</strong>と呼び、
母数がわかれば母集団分布を求めることができる。
例えば母集団が正規分布に従うと仮定する場合、
母数は平均$\mu$と分散$\sigma^{2}$にあたる。
分布に仮定を置く場合、標本から母数を求めることで母集団分布を知ることができる。</p>

<p>一方、分布に仮定を置かない場合を<strong>ノンパラメトリック</strong>と呼ぶ。<br />
この場合は母集団分布に依らない普遍的なパラメータで分析をおこなう。<br />
例えば、分布の位置に関するパラメータとしてmean、median、mode、<br />
ばらつきに関するものとして母分散、レンジなど、<br />
分布の形に関するものとして歪度、尖度などがある。</p>

<h2 id="母数と統計量">母数と統計量</h2>

<p>母集団全体を調べることが難しい場合、<br />
大きさ$n$の標本$X_{1},X_{2},\cdots,X_{n}$をとる。<br />
標本$X_{1},X_{2},\cdots,X_{n}$は独立で、<br />
それぞれが母平均$\mu$、母分散$\sigma^{2}$の母集団分布に従う確率変数であるとする。</p>

<script type="math/tex; mode=display">E(X_{1})=\dots=E(X_{n})=E(X)=\mu</script>

<script type="math/tex; mode=display">V(X_{1})=\dots=V(X_{n})=V(X)=\sigma^{2}</script>

<h3 id="標本平均-sample-mean">標本平均 (sample mean)</h3>

<script type="math/tex; mode=display">\bar{X}=\cfrac{1}{n}\sum_{i}^{n}X_{i}</script>

<p>標本平均$\bar{X}$の期待値$E\left(\bar{X}\right)$は</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
E\left(\bar{X}\right)
&=E\left(\cfrac{\sum_{i}^{n}X_{i}}{n}\right) \\
&=\cfrac{1}{n}\sum_{i}^{n}E\left(X_{i}\right) \\
&=\cfrac{n\mu}{n}=\mu
\end{align} %]]></script>

<p>となり、母平均と一致する。</p>

<p>また、標本平均$\bar{X}$の分散$V\left(\bar{X}\right)$は</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
V\left(\bar{X}\right)
&=V\left(\cfrac{1}{n}\sum_{i}^{n}X_{i}\right) \\
&=\cfrac{1}{n^{2}} \sum_{i}^{n}V(X_{i}) \\
&=\cfrac{n\sigma^{2}}{n^{2}}=\cfrac{\sigma^{2}}{n}
\end{align} %]]></script>

<p>となることから、$n\to \infty$のとき$\bar{X}$の分散は0に近づき、<br />
$\bar{X}$の期待値は$\mu$に収束していくことがわかる。</p>

<h3 id="標本分散-sample-variance">標本分散 (sample variance)</h3>

<script type="math/tex; mode=display">s^{2}=\cfrac{1}{n}\sum_{i}^{n}\left(X_{i}-\bar{X}\right)^{2}</script>

<p>標本分散$s^{2}$の期待値$E(s^{2})$は</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
E\left(s^{2}\right)
&=\cfrac{1}{n} \sum_{i}^{n} E\left(\left(X_{i} - \bar{X}\right)^{2}\right) \\
&=\cfrac{1}{n} \sum_{i}^{n} X_{i}^{2} - \bar{X}^{2} \\
&=\cfrac{1}{n}\sum_{i}^{n} E\left(X_{i}^{2}\right) - E\left(\bar{X}^{2}\right) \\
&=E\left(X^2\right) - E\left(\bar{X}^{2}\right) \\
&=\sigma^{2}+E(X)^{2}-E(\bar{X}^{2}) \quad \left( \sigma^{2}=E(X^{2})-E(X)^{2}\right) \\
&=\sigma^{2}-\left( E(\bar{X}^{2})-E(\bar{X})^{2} \right) \quad \left(E(X)=E(\bar{X})\right) \\
&=\sigma^{2}-\cfrac{\sigma^{2}}{n} \quad \left( E(\bar{X}^{2})-E(\bar{X})^{2} = \cfrac{\sigma^{2}}{n}\right) \\
&= \cfrac{n-1}{n} \sigma^{2}
\end{align} %]]></script>

<p>となり、$\cfrac{n}{n-1}s^{2}$の期待値が母分散$\sigma^{2}$に等しいことになる。<br />
$s^{2}$の定義より、$\cfrac{1}{n-1}\sum_{i}^{n}\left(X_{i}-\bar{X}\right)^{2}$の期待値が母分散$\sigma^{2}$に等しくなることがわかる。<br />
これを<strong>不偏分散(unbiased variance)</strong>という。</p>

<h3 id="不偏分散と自由度">不偏分散と自由度</h3>

<script type="math/tex; mode=display">{s^{'}}^{2}=\cfrac{1}{n}\sum_{i}^{n}\left(X_{i}-\bar{X}\right)^{2}</script>

<p>不偏分散の$n-1$は<strong>自由度(degree of freedom)</strong>といい、<br />
自由に動ける変数の数を意味する。</p>

<p>母集団から$n$個の標本を抽出する場合、<br />
標本平均の自由度は$n$であるため標本和を自由度$n$で割ることで求められる。<br />
一方、標本分散の計算は標本平均を用いた偏差平方和であるため、</p>

<script type="math/tex; mode=display">(X_{1}-\bar{X})+(X_{2}-\bar{X})\cdots+(X_{n}-\bar{X})=0</script>

<p>なので、$n-1$個の偏差の値が決まれば最後の偏差$X_{n}-\bar{X}$の値も決まってしまう。<br />
そのため自由度は$n-1$となり、$n$で割ると母分散より小さく評価してしまう。<br />
これが不偏分散の$n-1$で割ることの直感的な説明である。</p>

<h2 id="標本分布">標本分布</h2>

<p>標本和$X_{1}+X_{2}+\cdots+X_{n}$や標本平均$\bar{X}$の標本分布は母集団分布に依存する。<br />
特にパラメトリックの場合においては、分布が<strong>再生性(reproductive property)</strong>を持っている場合簡単に求められる。<br />
再生性とは、独立な2つ以上の確率変数が同一の分布族に属する場合<br />
その和もその分布に属することである。</p>

<h3 id="二項母集団">二項母集団</h3>

<p>母集団分布が母数$p$のベルヌーイ分布$Bi(1,p)$ならば<br />
$X_{1}+X_{2}+\cdots+X_{n}$の分布は二項分布$Bi(n,p)$に従う。</p>

<h3 id="ポアソン母集団">ポアソン母集団</h3>

<p>母集団分布が母数$\lambda$のポアソン分布$Po(\lambda)$ならば<br />
$X_{1}+X_{2}+\cdots+X_{n}$の分布は二項分布$Po(\lambda n)$に従う。</p>

<h3 id="正規母集団">正規母集団</h3>

<p>母集団分布が母数$\mu, \sigma^{2}$の正規分布$N(\mu, \sigma^{2})$ならば<br />
$X_{1}+X_{2}+\cdots+X_{n}$の分布は二項分布$N(n\mu, n\sigma^{2})$に従う。</p>

<h2 id="有限母集団">有限母集団</h2>

<p>母集団の大きさ$N$があまり大きくない場合や$\cfrac{n}{N}$が大きい場合、<br />
無限母集団を仮定するのは適当ではない。<br />
母平均$\mu$、母分散$\sigma^{2}$である有限母集団では</p>

<ul>
  <li>$\bar{X}$の期待値$E(\bar{X})$は、無限母集団の場合と同様に$\mu$と等しい。</li>
  <li>$\bar{X}$の分散$V(\bar{X})$は、$\cfrac{N-n}{N-1}\cdot\cfrac{\sigma^{2}}{n}$となる。</li>
</ul>

<p>$C_{N}=\cfrac{N-n}{N-1}\cdot\cfrac{\sigma^{2}}{n}$は無限母集団の場合の分散を修正する係数であり、<br />
<strong>有限母集団修正</strong>と呼ばれる。<br />
有限母集団修正$C_{N}$は無限母集団の極限$N\rightarrow\infty$で$C_{N}\rightarrow1$となる。</p>

<h2 id="練習問題">練習問題</h2>

<h3 id="92">9.2</h3>

<p>多数のねじが入っている箱から取り出した6本のねじの直径が</p>

<script type="math/tex; mode=display">1.22, 1.24, 1.25, 1.19, 1.17, 1.18</script>

<p>だったとき、標本平均$\bar{X}$と標本分散$s^{2}$を計算せよ。</p>

<hr />

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\bar{X} &= \cfrac{1.22 + 1.24 + 1.25 + 1.19 + 1.17 + 1.18}{6} \\
        &= \cfrac{7.25}{6} \\
        &\simeq 1.21 \\\\
s^{2} &= E(X^2) - E(X)^{2} \\
      &= \cfrac{1.22^2 + 1.24^2 + 1.25^2 + 1.19^2 + 1.17^2 + 1.18^2}{6}
            - \left( \cfrac{7.25}{6} \right)^{2} \\
      &= \cfrac{8.7659}{6} - \cfrac{52.5625}{36} \\
      &= 0.0009138888...
\end{align} %]]></script>

<h3 id="95">9.5</h3>

<p>A地点からB地点へ0または1の信号を送るとき、<br />
ノイズによりB時点での確率0.9で正しい信号を、確率0.1で誤った信号を受け取る。<br />
いま、信号の精度を改善するため、<br />
信号は$n$回繰り返し送り$n$回受信された信号のうち多いほうのものによって<br />
送られた信号が0か1であるかを決定する。<br />
$n=3,5$の場合、信号が正しく伝達される確率を求めよ。</p>

<hr />

<p>$n=3$のとき、信号が正しく伝達される確率は</p>

<script type="math/tex; mode=display">{}_3 \mathrm{C}_0\left(\frac{9}{10}\right)^{3}+{}_3 \mathrm{C}_1\left(\frac{9}{10}\right)^{2}\frac{1}{10}=0.972</script>

<p>$n=5$のとき、信号が正しく伝達される確率は</p>

<script type="math/tex; mode=display">{}_5 \mathrm{C}_0\left(\frac{9}{10}\right)^{5}+{}_5 \mathrm{C}_1\left(\frac{9}{10}\right)^{4}\frac{1}{10}+{}_5 \mathrm{C}_2\left(\frac{9}{10}\right)^{3}(\frac{1}{10})^{2}=0.99144</script>

<h3 id="96">9.6</h3>

<p>あるデパートの注文服売場の販売員のところへ来る1時間あたりの来客数は、<br />
$\lambda=1.5$のポアソン分布に従うという。<br />
午前3時間の来客数が5人以上である確率を求めよ。</p>

<hr />

<p>単位時間あたり平均$\lambda$回起こるようなランダムな事象が<br />
単位時間に$k$回起きる確率は、ポアソン分布より、</p>

<script type="math/tex; mode=display">P(k)=e^{-\lambda}\cfrac{\lambda^{k}}{k!}</script>

<p>来客が1人も来ない確率は$e^{-1.5\cdot3}\cfrac{(1.5\cdot3)^0}{0!}=0.01110$<br />
来客が1人である確率は$e^{-1.5\cdot3}\cfrac{(1.5\cdot3)^1}{1!}=0.04999$<br />
来客が2人である確率は$e^{-1.5\cdot3}\cfrac{(1.5\cdot3)^2}{2!}=0.1125$<br />
来客が3人である確率は$e^{-1.5\cdot3}\cfrac{(1.5\cdot3)^3}{3!}=0.1687$<br />
来客が4人である確率は$e^{-1.5\cdot3}\cfrac{(1.5\cdot3)^4}{4!}=0.1898$</p>

<p>以上より、午前3時間の来客数が5人以上である確率は</p>

<script type="math/tex; mode=display">1-(0.1898+0.1687+0.1125+0.04999+0.0111)=0.468</script>

<h3 id="97">9.7</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: center"> </th>
      <th style="text-align: center">北海道</th>
      <th style="text-align: center">東京</th>
      <th style="text-align: center">大阪</th>
      <th style="text-align: center">福岡</th>
      <th style="text-align: center">全国</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">交通事故死亡者数</td>
      <td style="text-align: center">9.7</td>
      <td style="text-align: center">4.0</td>
      <td style="text-align: center">5.7</td>
      <td style="text-align: center">7.8</td>
      <td style="text-align: center">8.4</td>
    </tr>
    <tr>
      <td style="text-align: center">交通事故死傷者数</td>
      <td style="text-align: center">526.6</td>
      <td style="text-align: center">508.7</td>
      <td style="text-align: center">703.8</td>
      <td style="text-align: center">867.2</td>
      <td style="text-align: center">621.6</td>
    </tr>
  </tbody>
</table>

<p>ある年における10万人当たりの交通事故死亡者数、交通事故死傷者数は上の通りであった。<br />
各都道府県において、人口10万人の年を考えるとき、</p>

<ol>
  <li>1年間の交通事故死亡者数が10人未満である確率を求めよ。</li>
  <li>1日の交通事故死傷者数が5人未満である確率を求めよ。</li>
</ol>

<hr />

<p>9.6と同じくポアソン分布を使って考える。</p>

<script src="https://gist.github.com/2bfe9c9c59a27a35807aea1f5a02ded0.js"> </script>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python3 statistics-introduction-section9-9.7.py
北海道の死亡者数が10人未満である確率は0.496
東京の死亡者数が10人未満である確率は0.992
大阪の死亡者数が10人未満である確率は0.935
福岡の死亡者数が10人未満である確率は0.741
北海道の死傷者数が5人未満である確率は0.984
東京の死傷者数が5人未満である確率は0.986
大阪の死傷者数が5人未満である確率は0.954
福岡の死傷者数が5人未満である確率は0.907
</code></pre></div></div>

<h3 id="98">9.8</h3>

<p>5人からなる母集団の身長が$171.0, 167.3, 170.6, 178.7, 162.3(cm)$であった。</p>

<ol>
  <li>この母集団の平均を求めよ。</li>
  <li>これから3人を標本として抽出する。すべての可能な標本を書き出し、それぞれの標本について標本平均$\bar{X}$、標本分散$\sigma^{2}$を計算せよ。</li>
  <li>標本平均の確率分布、期待値、分散を2の結果から求めよ。期待値は母平均に等しいこと、分散は式(9.11)で計算される値となることを示せ。</li>
</ol>

<hr />

<script src="https://gist.github.com/e9ecd9a108006266a082d7599fe5c9e5.js"> </script>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python3 statistics-introduction-section9-9.8.py
母平均は169.98、母分散は28.726
有限母集団修正した母分散は4.788
<span class="o">(</span>171.0, 167.3, 170.6<span class="o">)</span>の3人の標本平均は169.633、標本分散は2.749
<span class="o">(</span>171.0, 167.3, 178.7<span class="o">)</span>の3人の標本平均は172.333、標本分散は22.549
<span class="o">(</span>171.0, 167.3, 162.3<span class="o">)</span>の3人の標本平均は166.867、標本分散は12.709
<span class="o">(</span>171.0, 170.6, 178.7<span class="o">)</span>の3人の標本平均は173.433、標本分散は13.896
<span class="o">(</span>171.0, 170.6, 162.3<span class="o">)</span>の3人の標本平均は167.967、標本分散は16.082
<span class="o">(</span>171.0, 178.7, 162.3<span class="o">)</span>の3人の標本平均は170.667、標本分散は44.882
<span class="o">(</span>167.3, 170.6, 178.7<span class="o">)</span>の3人の標本平均は172.2、標本分散は22.94
<span class="o">(</span>167.3, 170.6, 162.3<span class="o">)</span>の3人の標本平均は166.733、標本分散は11.642
<span class="o">(</span>167.3, 178.7, 162.3<span class="o">)</span>の3人の標本平均は169.433、標本分散は47.102
<span class="o">(</span>170.6, 178.7, 162.3<span class="o">)</span>の3人の標本平均は170.533、標本分散は44.829
標本平均の期待値は169.98、分散は4.788
</code></pre></div></div>

            <ul class="social-buttons">
  <!-- hatena bookmark -->
  <li>
    <a href="http://b.hatena.ne.jp/entry/ysk24ok.github.io/2016/06/27/statistics-introduction-section9.html" class="hatena-bookmark-button" data-hatena-bookmark-title="統計学入門 第9章 -標本分布- メモ - ysk24ok.github.io" data-hatena-bookmark-layout="simple-balloon" title="このエントリーをはてなブックマークに追加">
      <img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
    </a>
    <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
  </li>
  <!-- twitter -->
  <li>
    <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </li>
</ul>

          </div>
        </div>
        <footer>
  This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
</footer>

      </div>
    </div>
  </body>
</html>
