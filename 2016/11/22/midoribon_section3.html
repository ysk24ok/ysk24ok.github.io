<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="author" content="ysk24ok">
  
  <meta name="description" content="みどりぼん第3章を読んでポアソン回帰について自分の理解をまとめた。">
  <meta property="og:description" content="みどりぼん第3章を読んでポアソン回帰について自分の理解をまとめた。">
  
  <meta property="og:image" content="https://ysk24ok.github.io/assets/images/profile.jpeg">
  <meta property="og:title" content="みどりぼん 第3章 ポアソン回帰">
  <meta property="og:url" content="https://ysk24ok.github.io/2016/11/22/midoribon_section3.html">
  <meta property="og:type" content="article">
  <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
  <!-- MathJax -->
  <!-- http://docs.mathjax.org/en/latest/start.html#secure-access-to-the-cdn -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ['\\(','\\)'] ],
        processEscapes: true
      }
    });
  </script>
  <script type="text/javascript" async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- bootstrap -->
  <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap.min.css">
  <script src="/assets/js/jquery-2.1.4.min.js"></script>
  <script src="/assets/js/bootstrap.min.js"></script>
  <!-- github.io default -->
  <link rel="stylesheet" type="text/css" href="/assets/css/stylesheet.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/assets/css/github-dark.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/assets/css/print.css" media="print">
  <!-- syntax highlight css -->
  <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css" media="screen">
  <!-- My customized css -->
  <link rel="stylesheet" type="text/css" href="/assets/css/linkpreview.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/assets/css/main.css" media="screen">
  <!-- RSS -->
  <link href="/feed.xml" type="application/rss+xml" rel="alternate" title="ysk24ok.github.io" />
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131519041-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-131519041-1');
  </script>
  <!--[if lt IE 9]>
  <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <title>みどりぼん 第3章 ポアソン回帰 - ysk24ok.github.io</title>
</head>

  <body>
    <div id="container">
      <div class="inner">
        <header>
  <h1><a href="/">ysk24ok.github.io</a></h1>
</header>
<nav class="navbar navbar-default" role="navigation">
  <ul id="main-navigation" class="nav navbar-nav">
    <li><a href="/">Home</a></li>
    <li><a href="/about">About</a></li>
  </ul>
</nav>

        <div class="post-item">
          <div class="post-header">
  <h1>
    <a href="/2016/11/22/midoribon_section3.html">みどりぼん 第3章 ポアソン回帰</a>
  </h1>
  <ul class="post-tags">
    
      <li><a href="#">midoribon</a></li>
    
      <li><a href="#">GLM</a></li>
    
      <li><a href="#">Japanese</a></li>
    
  </ul>
  
  <div class="post-date">posted on 22 Nov 2016</div>
  
  <hr>
</div>

          <div class="post-content">
            <ul class="social-buttons">
  <!-- hatena bookmark -->
  <li>
    <a href="http://b.hatena.ne.jp/entry/ysk24ok.github.io/2016/11/22/midoribon_section3.html" class="hatena-bookmark-button" data-hatena-bookmark-title="みどりぼん 第3章 ポアソン回帰 - ysk24ok.github.io" data-hatena-bookmark-layout="simple-balloon" title="このエントリーをはてなブックマークに追加">
      <img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
    </a>
    <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
  </li>
  <!-- twitter -->
  <li>
    <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </li>
</ul>

            <p>みどりぼん第3章を読んでポアソン回帰について自分の理解をまとめた。</p>

<!-- more -->

<h1 id="ポアソン分布">ポアソン分布</h1>

<p>ポアソン分布の確率分布は以下の式で表される。</p>

<script type="math/tex; mode=display">p(X=y|\lambda)=\cfrac{\lambda^{y}\exp(-\lambda)}{y!}</script>

<p>$p(X=y|\lambda)$は分布の平均が$\lambda$であるときに<br />
ポアソン分布にしたがう確率変数$X$が$y$になる確率である。</p>

<h1 id="ポアソン回帰">ポアソン回帰</h1>

<p>ここで、架空の植物の種子数をモデル化することを考える。</p>

<h2 id="lambdaが全個体で共通の場合">$\lambda$が全個体で共通の場合</h2>

<p>どの個体の種子数$y_{i}$も平均$\lambda$のポアソン分布にしたがう場合、<br />
個体$i$の種子数が$y_{i}$になる確率は以下の式で表される。</p>

<script type="math/tex; mode=display">p(X=y_{i}|\lambda)=\cfrac{\lambda^{y_{i}}\exp(-\lambda)}{y_{i}!}</script>

<p>対数尤度関数は</p>

<script type="math/tex; mode=display">\log L(\lambda)=\sum_{i}\log(p(X=y_{i}|\lambda))</script>

<p>となる。</p>

<h2 id="lambdaが個体によって異なる場合">$\lambda$が個体によって異なる場合</h2>

<p>個体ごとに異なる説明変数によって平均種子数が変わる場合、<br />
個体$i$の種子数が$y_{i}$になる確率は以下の式で表される。</p>

<script type="math/tex; mode=display">p(X=y_{i}|\lambda_{i})=\cfrac{\lambda_{i}^{y_{i}}\exp(-\lambda_{i})}{y_{i}!}</script>

<p>個体ごとの平均種子数$\lambda_{i}$が体サイズ$x_{i}$に影響されるとき、<br />
線形予測子(linear predictor)と対数リンク関数(log link function)を使って、</p>

<script type="math/tex; mode=display">\log \lambda_{i} = \beta_{1}+\beta_{2}x_{i}</script>

<p>と表される。</p>

<p>$\lambda_{i}$は$\beta_{1}, \beta_{2}$の関数なので、対数尤度関数は</p>

<script type="math/tex; mode=display">\log L(\beta_{1},\beta_{2})=\sum_{i}\log(p(X=y_{i}|\beta_{1},\beta_{2}))</script>

<p>となる。</p>

<h1 id="正規分布回帰">正規分布回帰</h1>

<p>種子数がポアソン分布ではなく正規分布にしたがうと考えたとき、
種子数が$y_{i}$となる確率$p(y_{i}|\mu_{i}, \sigma_{i})$は、</p>

<script type="math/tex; mode=display">p(y_{i}|\mu_{i}, \sigma_{i})=\cfrac{1}{\sqrt{2\pi \sigma_{i}^{2}}}\exp\left(-\cfrac{(y_{i}-\mu_{i})^{2}}{2\sigma_{i}^{2}}\right)</script>

<p>で表される。ここで、$\mu$は平均、$\sigma$は標準偏差である。</p>

<p>対数尤度関数は以下の式で表される。</p>

<script type="math/tex; mode=display">\log L(\mu_{i}, \sigma_{i})=-\cfrac{1}{2}\sum_{i}\log(2\pi\sigma_{i}^{2})-\cfrac{1}{2\sigma^{2}}\sum_{i}(y_{i}-\mu_{i})</script>

<p>ここで分散$\sigma_{i}^{2}$は平均$\mu_{i}$によらず一定とすると、</p>

<script type="math/tex; mode=display">\log L(\mu_{i})=-\sum_{i}(y_{i}-\mu_{i})</script>

<p>線形予測子と恒等リンク関数を使って$\mu_{i}=\beta_{1}+\beta_{2}x_{i}$と表すと、</p>

<script type="math/tex; mode=display">\log L(\beta_{1},\beta_{2})=-\sum_{i}(y_{i}-(\beta_{1}+\beta_{2}x_{i}))</script>

<p>となる。<br />
この式より、正規分布回帰の回帰パラメータを最尤推定することは最小二乗法と同じになることがわかる。</p>

<p>ただし、</p>

<ul>
  <li>離散値をとる目的変数のモデリングに連続値の分布である正規分布を使っている</li>
  <li>種子数$y$が負になりうる</li>
  <li>平均の値に関わらず分散一定を仮定している</li>
</ul>

<p>などの理由で、種子数のモデリングに正規分布を用いるのは適切ではない。</p>

<h1 id="サンプルデータを使って種子数をモデリング">サンプルデータを使って種子数をモデリング</h1>

<p><a href="http://hosho.ees.hokudai.ac.jp/~kubo/stat/iwanamibook/fig/poisson/data3a.csv">本書で使用されていたサンプルデータ</a>を使って、</p>

<ul>
  <li>説明変数が体サイズ$x$のみ</li>
  <li>説明変数が施肥処理$f$のみ</li>
  <li>説明変数が体サイズ$x$と施肥処理$f$</li>
</ul>

<p>の3パターンで種子数をモデリングする。</p>

<script src="https://gist.github.com/ysk24ok/436f5ce58560919530ca5608a93110d6.js"></script>

<h1 id="まとめ">まとめ</h1>

<ul>
  <li>どの分布を使用するかについて
    <ul>
      <li>実データの応答変数$y$の構造をよく考えて分布を選ぶことが重要</li>
      <li>なんでも正規分布を仮定して直線回帰させれば良いというものではない</li>
    </ul>
  </li>
  <li>どのリンク関数を使用するかについて
    <ul>
      <li>分布関係なく、恒等リンク関数を用いた場合$y$の回帰値の集合は直線に、<br />
対数リンク関数を用いた場合は指数関数となる</li>
      <li>ちなみに、正規分布の正準リンク関数は恒等リンク関数、<br />
ポアソン分布は対数リンク関数である</li>
      <li>恒等リンク関数を使った場合、各説明変数の回帰値への効果は加算で表され、<br />
対数リンク関数を使った場合は乗算で表される</li>
    </ul>
  </li>
  <li>目的変数が種子数のようなカウントデータの場合はポアソン回帰を用いるとあるが、<br />
平均値が大きくサンプルサイズが十分ある場合は正規分布にしたがうとしてもよい
    <ul>
      <li>中心極限定理により、平均値（あるいは合計値）の分布は正規分布に近づくため</li>
      <li>事実、ポアソン分布でも$\lambda$が大きくなると分布の形は正規分布に近づく</li>
      <li>種子数は平均値が小さく、ポアソン回帰が適していたと思われる</li>
      <li>詳しくは<a href="http://www.anlyznews.com/2013/09/blog-post_2173.html">銀座で働くデータサイエンティストのモデル選択について: ニュースの社会科学的な裏側</a>を参照</li>
    </ul>
  </li>
</ul>

<h1 id="疑問">疑問</h1>

<ul>
  <li>みどりぼんによると、ポアソン分布で対数リンク関数を使う理由は<br />
「推定計算に都合よく」かつ「わかりやすい」からとあるが、理論的な理由があるのか？</li>
  <li>正規分布で対数リンク関数を使うなど、<br />
正準リンク関数ではないリンク関数を使う場面は存在するのか？
    <ul>
      <li>$x$が増加すると$y$は指数的に増加し、ばらつきは一定であるような場合？</li>
      <li><a href="http://d.hatena.ne.jp/mrkm-a/20140513/p1">対数変換と一般化線形モデル - DTAL（旧RCEAL）留学記録</a>によると、<br />
$y=a e^{bx}+\epsilon$のような指数関数で正規分布+対数リンク関数を使っている</li>
    </ul>
  </li>
</ul>

<h1 id="参考文献サイト">参考文献・サイト</h1>

<ul>
  <li><a href="http://hosho.ees.hokudai.ac.jp/~kubo/ce/IwanamiBook.html">データ解析のための統計モデリング入門</a> 第3章</li>
  <li><a href="http://hosho.ees.hokudai.ac.jp/~kubo/stat/2013/ou1/kubostat2013ou1.pdf">一般化線形 (混合) モデル (1) - 確率分布，最尤推定，ポアソン回帰</a></li>
  <li><a href="http://d.hatena.ne.jp/tomsekiguchi/20140209/1391944929">一般化線形モデルとは何か - 講義のページにようこそ</a></li>
  <li><a href="http://imaimamu.com/archives/1928">Pythonで「データ解析のための統計モデリング入門」：第3章</a></li>
  <li><a href="http://d.hatena.ne.jp/mrkm-a/20140513/p1">対数変換と一般化線形モデル - DTAL（旧RCEAL）留学記録</a></li>
  <li><a href="http://tjo.hatenablog.com/entry/2013/09/18/235052">今さら人に聞けない「重回帰分析の各手法の使い分け」 - 六本木で働くデータサイエンティストのブログ</a></li>
  <li><a href="http://tjo.hatenablog.com/entry/2013/09/23/232814">「使い分け」ではなく「妥当かどうか」が大事：重回帰分析＆一般化線形モデル選択まわりの再まとめ - 六本木で働くデータサイエンティストのブログ</a></li>
  <li><a href="http://www.anlyznews.com/2013/09/blog-post_2173.html">銀座で働くデータサイエンティストのモデル選択について: ニュースの社会科学的な裏側</a></li>
  <li><a href="http://uncorrelated.hatenablog.com/entry/20130919/1379599682">ポアソン回帰で推定しているモノはλの式 -  餡子付゛録゛</a></li>
</ul>

            <ul class="social-buttons">
  <!-- hatena bookmark -->
  <li>
    <a href="http://b.hatena.ne.jp/entry/ysk24ok.github.io/2016/11/22/midoribon_section3.html" class="hatena-bookmark-button" data-hatena-bookmark-title="みどりぼん 第3章 ポアソン回帰 - ysk24ok.github.io" data-hatena-bookmark-layout="simple-balloon" title="このエントリーをはてなブックマークに追加">
      <img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
    </a>
    <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
  </li>
  <!-- twitter -->
  <li>
    <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </li>
</ul>

          </div>
        </div>
        <footer>
  This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
</footer>

      </div>
    </div>
  </body>
</html>
