<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="author" content="ysk24ok">
  
  <meta name="description" content="My blog posts, slides and past works">
  <meta property="og:description" content="My blog posts, slides and past works">
  
  <meta property="og:image" content="https://ysk24ok.github.io/assets/images/profile.jpeg">
  <meta property="og:title" content="統計学入門 第8章 -大数の法則と中心極限定理- メモ">
  <meta property="og:url" content="https://ysk24ok.github.io/2016/05/14/statistics-introduction-section8.html">
  <meta property="og:type" content="">
  <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
  <!-- MathJax -->
  <!-- http://docs.mathjax.org/en/latest/start.html#secure-access-to-the-cdn -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ['\\(','\\)'] ],
        processEscapes: true
      }
    });
  </script>
  <script type="text/javascript" async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- bootstrap -->
  <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap.min.css">
  <script src="/assets/js/jquery-2.1.4.min.js"></script>
  <script src="/assets/js/bootstrap.min.js"></script>
  <!-- github.io default -->
  <link rel="stylesheet" type="text/css" href="/assets/css/stylesheet.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/assets/css/github-dark.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/assets/css/print.css" media="print">
  <!-- syntax highlight css -->
  <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css" media="screen">
  <!-- My customized css -->
  <link rel="stylesheet" type="text/css" href="/assets/css/linkpreview.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/assets/css/main.css" media="screen">
  <!-- RSS -->
  <link href="/feed.xml" type="application/rss+xml" rel="alternate" title="ysk24ok.github.io" />
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131519041-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-131519041-1');
  </script>
  <!--[if lt IE 9]>
  <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <title>統計学入門 第8章 -大数の法則と中心極限定理- メモ - ysk24ok.github.io</title>
</head>

  <body>
    <div id="container">
      <div class="inner">
        <header>
  <h1><a href="/">ysk24ok.github.io</a></h1>
</header>
<nav class="navbar navbar-default" role="navigation">
  <ul id="main-navigation" class="nav navbar-nav">
    <li><a href="/">Home</a></li>
    <li><a href="/about">About</a></li>
  </ul>
</nav>

        <div class="post-item">
          <div class="post-header">
  <h1>
    <a href="/2016/05/14/statistics-introduction-section8.html">統計学入門 第8章 -大数の法則と中心極限定理- メモ</a>
  </h1>
  <ul class="post-tags">
    
      <li><a href="#">statistics</a></li>
    
      <li><a href="#">book</a></li>
    
      <li><a href="#">Japanese</a></li>
    
  </ul>
  
  <div class="post-date">posted on 14 May 2016</div>
  
  <hr>
</div>

          <div class="post-content">
            <ul class="social-buttons">
  <!-- hatena bookmark -->
  <li>
    <a href="http://b.hatena.ne.jp/entry/ysk24ok.github.io/2016/05/14/statistics-introduction-section8.html" class="hatena-bookmark-button" data-hatena-bookmark-title="統計学入門 第8章 -大数の法則と中心極限定理- メモ - ysk24ok.github.io" data-hatena-bookmark-layout="simple-balloon" title="このエントリーをはてなブックマークに追加">
      <img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
    </a>
    <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
  </li>
  <!-- twitter -->
  <li>
    <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </li>
</ul>

            <div class="post-img">
  <img src="/assets/images/statistics_introduction/cover.jpg" width="20%" />
</div>

<p><a href="http://www.utp.or.jp/bd/978-4-13-042065-5.html">統計学入門</a>の第8章をまとめた。</p>

<!-- more -->

<h2 id="大数の法則">大数の法則</h2>

<p>1回の試行で2種類の事象(コイン投げなら表・裏)のいずれかが生じ、<br />
そのような事象が生起する可能性が常に一定(コイン投げなら$\frac{1}{2}$)である試行を<br />
<strong>ベルヌーイ試行</strong>と呼ぶ。</p>

<p>コイン投げにおいて、表が出た場合を$1$、裏が出た場合を$0$をとる確率変数$x$を考える。<br />
$n$回のコイン投げで表が出た回数$r$は$x_{1}+x_{2}+\cdots+x_{n}$となり、<br />
この$r$は$n=10, p=0.5$の二項分布$Bi(10, 0.5)$に従う。</p>

<p>このとき、<strong>観測された成功率</strong>は$\frac{r}{n}$であるが、<br />
試行回数$n$を大きくすると観測された成功率は<strong>真の成功率</strong>$p=0.5$に近づいていく。<br />
これを<strong>大数の法則</strong>と呼ぶ。</p>

<!-- TODO: 大数の弱法則・強法則とその証明 -->
<!-- http://mathtrain.jp/lawoflargenumbers -->

<h2 id="中心極限定理">中心極限定理</h2>

<p><strong>中心極限定理</strong>によると、$n$が大きいとき母集団分布が何であっても<br />
標本和$x_{1}+x_{2}+\cdots+x_{n}$の確率分布は正規分布に従う。</p>

<p>母平均を$\mu$、母分散を$\sigma$とすると<br />
標本和$S_{n}=x_{1}+x_{2}+\cdots+x_{n}$は正規分布$N(n\mu, n\sigma^{2})$に、<br />
標本平均$\bar{x}=\frac{x_{1}+x_{2}+\cdots+x_{n}}{n}$は正規分布$N(\mu, \frac{\sigma^{2}}{n})$に従う。</p>

<p>大数の法則では$n$が大きいとき$\bar{x}\simeq\mu$であることを保証するが<br />
中心極限定理では$\bar{x}$は正規分布の形をとりながら$\mu$へ近づくことを保証しているという点で、<br />
中心極限定理の方がより詳しい定理であるといえる。</p>

<!-- TODO: 逆変換法 -->
<!-- http://aidiary.hatenablog.com/entry/20140622/1403403301 -->

<h3 id="二項分布の正規分布による近似">二項分布の正規分布による近似</h3>

<p>二項分布における成功の回数$S$は<br />
ベルヌーイ分布$Bi(1,p)$に従う確率変数$x_{1}, x_{2},\cdots,x_{n}$の和$S=x_{1}+x_{2}+\cdots+x_{n}$となり、<br />
$Bi(n,p)$は$n$が大きいとき正規分布$N(\mu, \sigma^2)$に近づく。</p>

<p>また、二項分布において$\mu=np, \sigma^{2}=np(1-p)$であることから、<br />
標準化変数$z=\cfrac{S-np}{\sqrt{np(1-p)}}$は標準正規分布$N(1,0)$に近づく<br />
ということもできる。</p>

<!-- 正規乱数の発生 -->

<h2 id="練習問題">練習問題</h2>

<h3 id="81">8.1</h3>

<p>確率変数$X_{1},X_{2},\cdots,X_{n}$が独立でベルヌーイ分布$Bi(1,p)$に従っているとき、中心極限定理から</p>

<script type="math/tex; mode=display">P(L \leq X_{1}+X_{2}+ \cdots +X_{n} \leq U)=0.95</script>

<p>となる$L, U$を求めよ。<br />
また、$n=700, p=0.4$のときの$L, U$の値を求めよ。</p>

<hr />

<p>中心極限定理より、二項分布$Bi(n,p)$の平均の分布は正規分布$N(\mu, \frac{\sigma^{2}}{n})$となる。</p>

<p>母平均$\mu=\frac{(X_{1}+X_{2}+ \cdots +X_{n})}{n}$に対する信頼度95%のときの信頼区間は</p>

<script type="math/tex; mode=display">p - 1.96 \frac{\sigma}{\sqrt{n}} \leq \mu \leq p + 1.96 \frac{\sigma}{\sqrt{n}}</script>

<p>一方、二項分布$Bi(n,p)$の総和の分布は中心極限定理より正規分布$N(n\mu, n\sigma^{2})$に従う。</p>

<script type="math/tex; mode=display">np - 1.96 \sigma \leq n\mu \leq np + 1.96 \sigma</script>

<p>二項分布$B(n,p)$では$\sigma^{2}=np(1-p)$なので</p>

<script type="math/tex; mode=display">np - 1.96\sqrt{np(1-p)} \leq n\mu \leq np + 1.96\sqrt{np(1-p)}</script>

<p>$L=np - 1.96\sqrt{np(1-p)}$、$U=np + 1.96\sqrt{np(1-p)}$</p>

<p>$n=700$、$p=0.4$のとき、$L=254.6$、$P=305.4$</p>

<h3 id="82">8.2</h3>

<p>確率変数$X_{1},X_{2},\cdots,X_{n}$は独立で</p>

<script type="math/tex; mode=display">P(X_{i}=1)=p, P(X_{i}=-1)=q \quad (i=1,2,\cdots,n)</script>

<p>に従っている。ただし、$q=1-p$</p>

<ol>
  <li>$n$が大きいとき、$S_n=X_{1}+X_{2}+ \cdots +X_{n}$の近似的確率分布を求めよ。</li>
  <li>$p=0.4$のとき、$S_{10}, S_{20}$の近似的確率をグラフにせよ。</li>
</ol>

<hr />

<p>1.</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
E(X) &= 1 \cdot p + -1 \cdot q \\
     &= p-q \\
V(X) &= E(X^2)-E(X)^2 \\
     &=1^2 \cdot p + (-1)^2 \cdot q - (p-q)^2 \\
     &=p(1-p)+2pq+q(1-q) \\
     &=4pq
\end{align} %]]></script>

<p>中心極限定理より、$S_n$の分布は正規分布$N(n(p-q), 4npq)$となる。</p>

<p>2.</p>

<p>略</p>

<h3 id="83">8.3</h3>

<p>昨シーズン2割8分の打率だった打者が今シーズンもこの確率でヒットを打つものとすると、</p>

<ol>
  <li>今シーズン450打数だった場合3割バッターになれる確率はどれくらいか。</li>
  <li>このバッターが確率0.2以上で3割バッターになろうとすると打数はどのくらいか。</li>
</ol>

<hr />

<p>確率変数$X$がベルヌーイ分布$Bi(1,p)$に従うとき、<br />
標準化変数$Z=\cfrac{S-np}{\sqrt{np(1-p)}}$は標準正規分布で近似できる。</p>

<p>$p=0.28, p^{‘}=0.3, n=450$とすると、</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
P\left(X\geq np^{'}\right)
&=P\left(Z \geq \cfrac{np^{'}-np}{\sqrt{np(1-p)}}\right) \\
&=P\left(Z \geq \cfrac{450\cdot(0.3-0.28)}{\sqrt{450\cdot0.28\cdot0.72}}\right) \\
&\simeq P\left(Z \geq 0.9449 \right)
\end{align} %]]></script>

<p>付表1の標準正規分布表(上側確率)より、$Z=0.94$のときの上側確率$Q(Z)$は0.1736<br />
よって、このバッターが3割バッターになる確率は0.1736</p>

<p>確率0.2以上で3割バッターになるためには、付表1の標準正規分布表(上側確率)より、$Z=0.84$</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
P\left(X\geq np^{'}\right)
&=P\left(Z \geq \cfrac{np^{'}-np}{\sqrt{np(1-p)}}\right) \\
&=P\left(Z \geq \cfrac{n\cdot(0.3-0.28)}{\sqrt{n\cdot0.28\cdot0.72}}\right) \\
&\simeq P\left(Z \geq 0.84 \right)
\end{align} %]]></script>

<p>よって、$n\geq355.6$</p>

            <ul class="social-buttons">
  <!-- hatena bookmark -->
  <li>
    <a href="http://b.hatena.ne.jp/entry/ysk24ok.github.io/2016/05/14/statistics-introduction-section8.html" class="hatena-bookmark-button" data-hatena-bookmark-title="統計学入門 第8章 -大数の法則と中心極限定理- メモ - ysk24ok.github.io" data-hatena-bookmark-layout="simple-balloon" title="このエントリーをはてなブックマークに追加">
      <img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
    </a>
    <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
  </li>
  <!-- twitter -->
  <li>
    <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </li>
</ul>

          </div>
        </div>
        <footer>
  This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
</footer>

      </div>
    </div>
  </body>
</html>
